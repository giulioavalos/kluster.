<% if @album %>
  <h1><%= @album.name %></h1>
  <% if @album.images.any? %>
    <%= image_tag @album.images.first["url"], class: "album-image" %>
  <% end %>

 <!-- Liens pour ajouter/retirer des favoris -->
  <% if Favorite.find_by(user: current_user, spotify_item_id: @album.id).present? %>
    <%= link_to 'Remove from Favorites', favorite_path(Favorite.find_by(user: current_user, spotify_item_id: @album.id)), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: 'btn btn-warning' %>
  <% else %>
    <%= simple_form_for Favorite.new, url: album_favorites_url(@album.id) do |f| %>
      <%= f.submit "Add as favorite" %>
    <% end %>
  <% end %>

      <!-- Button to open the review form -->
  <%= link_to 'Leave a review', '#', class: 'btn btn-primary', id: 'open-review-form' %>

  <!-- Review form container (initially hidden) -->
  <div id="review-form-container" style="display: none;">
    <%= render 'reviews/form', review: @review, type: "album" %>
  </div>
  
  <ul>
    <% @tracks.each do |track| %>
      <li><%= track.name %></li>
    <% end %>
  </ul>

  <div class="review_section">
    <ul>
      <% Review.where(spotify_item_id: params[:id], spotify_item_type: "album").each do |review| %>
        <li>
          <%= review.rating %>
          <%= review.content %>
        </li>
      <% end %>
    </ul>
  </div>

  <!-- Script to show/hide the review form -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const openButton = document.getElementById('open-review-form');
      const formContainer = document.getElementById('review-form-container');

      openButton.addEventListener('click', function(event) {
        event.preventDefault();
        formContainer.style.display = 'flex';
      });
    });
  </script>
<% else %>
  <p>Album not found.</p>
<% end %>
